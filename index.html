<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IS Project Management Course</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Plus Jakarta Sans', sans-serif; }
    .lesson-card:hover { transform: translateY(-2px); }
    .progress-ring { transition: stroke-dashoffset 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    .animate-fade { animation: fadeIn 0.4s ease forwards; }
    .animate-slide { animation: slideIn 0.3s ease forwards; }
    .quiz-option:hover:not(.selected):not(.correct):not(.incorrect) { background: #f0fdf4; border-color: #22c55e; }
    .quiz-option.selected { background: #dbeafe; border-color: #3b82f6; }
    .quiz-option.correct { background: #dcfce7; border-color: #22c55e; }
    .quiz-option.incorrect { background: #fee2e2; border-color: #ef4444; }
    .activity-item.completed { opacity: 0.7; }
    .tab-active { border-bottom: 3px solid #22c55e; color: #166534; font-weight: 600; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 3px; }
  </style>
  <style>body { box-sizing: border-box; }</style>
 </head>
 <body class="h-full bg-slate-50 text-slate-800">
  <div id="app" class="h-full w-full overflow-auto"></div>
  <script>
    // Course Data Structure
    const courseData = {
      weeks: [
        {
          number: 1,
          title: "Introduction to Project Management",
          icon: "ðŸš€",
          color: "#22c55e",
          lessons: [
            {
              id: "w1l1",
              title: "What is Project Management?",
              duration: "25 min",
              content: `
                <h2>Understanding Project Management</h2>
                <p>Project management is the application of knowledge, skills, tools, and techniques to project activities to meet project requirements. It involves planning, organizing, and managing resources to bring about the successful completion of specific project goals and objectives.</p>
                
                <h3>Key Characteristics of a Project</h3>
                <ul>
                  <li><strong>Temporary:</strong> Has a definite beginning and end</li>
                  <li><strong>Unique:</strong> Creates a distinct product, service, or result</li>
                  <li><strong>Progressive elaboration:</strong> Developed in steps and increments</li>
                </ul>

                <h3>The Triple Constraint</h3>
                <p>Every project is constrained by three factors:</p>
                <div class="constraint-diagram">
                  <div class="constraint-item">ðŸ“… <strong>Time</strong> - Schedule and deadlines</div>
                  <div class="constraint-item">ðŸ’° <strong>Cost</strong> - Budget and resources</div>
                  <div class="constraint-item">ðŸ“‹ <strong>Scope</strong> - Features and quality</div>
                </div>

                <h3>Why Project Management Matters in IS</h3>
                <p>In Information Systems, project management is crucial because:</p>
                <ul>
                  <li>IT projects have high failure rates without proper management</li>
                  <li>Technology changes rapidly, requiring adaptive approaches</li>
                  <li>Stakeholder expectations must be carefully managed</li>
                  <li>Integration with existing systems adds complexity</li>
                </ul>
              `
            },
            {
              id: "w1l2",
              title: "Projects vs Operations",
              duration: "20 min",
              content: `
                <h2>Projects vs Operations</h2>
                <p>Understanding the difference between projects and operations is fundamental to project management.</p>

                <h3>Comparison Table</h3>
                <table>
                  <tr><th>Aspect</th><th>Projects</th><th>Operations</th></tr>
                  <tr><td>Duration</td><td>Temporary, finite</td><td>Ongoing, continuous</td></tr>
                  <tr><td>Objective</td><td>Achieve specific goal</td><td>Sustain business</td></tr>
                  <tr><td>Output</td><td>Unique deliverable</td><td>Repetitive products/services</td></tr>
                  <tr><td>Team</td><td>Assembled for project</td><td>Permanent staff</td></tr>
                  <tr><td>Change</td><td>Embraces change</td><td>Maintains stability</td></tr>
                </table>

                <h3>Examples in IS Context</h3>
                <div class="example-box">
                  <strong>Project Examples:</strong>
                  <ul>
                    <li>Implementing a new ERP system</li>
                    <li>Developing a mobile application</li>
                    <li>Migrating to cloud infrastructure</li>
                    <li>Building a data warehouse</li>
                  </ul>
                </div>
                <div class="example-box">
                  <strong>Operations Examples:</strong>
                  <ul>
                    <li>Help desk support</li>
                    <li>System maintenance</li>
                    <li>Daily backups</li>
                    <li>Network monitoring</li>
                  </ul>
                </div>
              `
            },
            {
              id: "w1l3",
              title: "Project Life Cycle",
              duration: "30 min",
              content: `
                <h2>The Project Life Cycle</h2>
                <p>Every project goes through distinct phases from start to finish. Understanding these phases helps in planning and managing projects effectively.</p>

                <h3>The Four Phases</h3>
                <div class="phase-container">
                  <div class="phase">
                    <span class="phase-num">1</span>
                    <strong>Initiation</strong>
                    <p>Define the project, get authorization, identify stakeholders</p>
                  </div>
                  <div class="phase">
                    <span class="phase-num">2</span>
                    <strong>Planning</strong>
                    <p>Develop project plan, define scope, schedule, budget</p>
                  </div>
                  <div class="phase">
                    <span class="phase-num">3</span>
                    <strong>Execution</strong>
                    <p>Perform work, manage team, communicate with stakeholders</p>
                  </div>
                  <div class="phase">
                    <span class="phase-num">4</span>
                    <strong>Closure</strong>
                    <p>Finalize deliverables, release resources, document lessons learned</p>
                  </div>
                </div>

                <h3>Monitoring & Controlling</h3>
                <p>This process group runs throughout the project lifecycle, tracking progress, managing changes, and ensuring project stays on track.</p>

                <h3>IS Project Life Cycle Variations</h3>
                <ul>
                  <li><strong>Waterfall:</strong> Sequential, phase-by-phase approach</li>
                  <li><strong>Agile:</strong> Iterative, incremental delivery</li>
                  <li><strong>Hybrid:</strong> Combination of approaches</li>
                </ul>
              `
            }
          ],
          activities: [
            {
              id: "w1a1",
              title: "Identify the Project",
              type: "reflection",
              description: "Think of a recent IT project in your organization or one you've heard about. List its key characteristics that make it a 'project' rather than 'operations'.",
              instructions: [
                "Name the project",
                "Describe its temporary nature (start and end)",
                "Explain what makes the deliverable unique",
                "Identify the triple constraints involved"
              ]
            },
            {
              id: "w1a2",
              title: "Life Cycle Mapping",
              type: "exercise",
              description: "Map a simple IS project through all four life cycle phases.",
              instructions: [
                "Choose a project: 'Implement a new email system'",
                "List 3 key activities for each phase",
                "Identify potential challenges at each phase",
                "Note who would be involved at each stage"
              ]
            }
          ],
          quiz: {
            id: "w1q",
            title: "Week 1 Assessment",
            questions: [
              {
                id: "w1q1",
                question: "Which of the following is NOT a characteristic of a project?",
                options: ["Temporary", "Unique deliverable", "Ongoing and repetitive", "Progressive elaboration"],
                correct: 2,
                explanation: "Projects are temporary with unique deliverables. 'Ongoing and repetitive' describes operations, not projects."
              },
              {
                id: "w1q2",
                question: "The 'Triple Constraint' in project management consists of:",
                options: ["Time, Cost, Quality", "Time, Cost, Scope", "Scope, Resources, Risk", "Budget, Schedule, Team"],
                correct: 1,
                explanation: "The Triple Constraint consists of Time (Schedule), Cost (Budget), and Scope. Quality is often considered at the center of these three."
              },
              {
                id: "w1q3",
                question: "During which phase is the Project Charter created?",
                options: ["Planning", "Execution", "Initiation", "Closure"],
                correct: 2,
                explanation: "The Project Charter is created during the Initiation phase to formally authorize the project."
              },
              {
                id: "w1q4",
                question: "Which is an example of operations rather than a project?",
                options: ["Developing a new mobile app", "Daily system backups", "Migrating to cloud", "Building a data warehouse"],
                correct: 1,
                explanation: "Daily system backups are repetitive, ongoing activities that sustain business operations."
              },
              {
                id: "w1q5",
                question: "Monitoring and Controlling processes occur during:",
                options: ["Only the execution phase", "Only planning and execution", "Throughout all phases", "Only at project closure"],
                correct: 2,
                explanation: "Monitoring and Controlling is performed throughout the entire project lifecycle to track progress and manage changes."
              }
            ]
          }
        },
        {
          number: 2,
          title: "PM Frameworks & the Project Manager",
          icon: "ðŸ“š",
          color: "#3b82f6",
          lessons: [
            {
              id: "w2l1",
              title: "Project Management Frameworks",
              duration: "30 min",
              content: `
                <h2>Project Management Frameworks</h2>
                <p>A framework provides structure and guidance for managing projects. Different frameworks suit different types of projects and organizations.</p>

                <h3>Popular Frameworks</h3>
                <div class="framework-grid">
                  <div class="framework-card">
                    <strong>PMBOK (PMI)</strong>
                    <p>Process-based approach with 5 process groups and 10 knowledge areas. Industry standard for traditional PM.</p>
                  </div>
                  <div class="framework-card">
                    <strong>PRINCE2</strong>
                    <p>Product-based approach focused on business justification. Popular in UK and Europe.</p>
                  </div>
                  <div class="framework-card">
                    <strong>Agile/Scrum</strong>
                    <p>Iterative approach with short sprints, daily standups, and continuous delivery.</p>
                  </div>
                  <div class="framework-card">
                    <strong>Lean</strong>
                    <p>Focus on eliminating waste and maximizing value. Derived from manufacturing.</p>
                  </div>
                </div>

                <h3>Choosing the Right Framework</h3>
                <ul>
                  <li><strong>Predictive (Waterfall):</strong> When requirements are clear and stable</li>
                  <li><strong>Agile:</strong> When requirements evolve and rapid delivery is needed</li>
                  <li><strong>Hybrid:</strong> Complex projects needing flexibility with structure</li>
                </ul>
              `
            },
            {
              id: "w2l2",
              title: "PMBOK Knowledge Areas",
              duration: "35 min",
              content: `
                <h2>PMBOK 10 Knowledge Areas</h2>
                <p>The Project Management Body of Knowledge (PMBOK) organizes project management into 10 knowledge areas.</p>

                <div class="knowledge-areas">
                  <div class="ka-item">
                    <span class="ka-num">1</span>
                    <strong>Integration Management</strong>
                    <p>Coordinates all other knowledge areas</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">2</span>
                    <strong>Scope Management</strong>
                    <p>Defines and controls what is included</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">3</span>
                    <strong>Schedule Management</strong>
                    <p>Manages timely completion</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">4</span>
                    <strong>Cost Management</strong>
                    <p>Plans and controls budget</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">5</span>
                    <strong>Quality Management</strong>
                    <p>Ensures deliverables meet standards</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">6</span>
                    <strong>Resource Management</strong>
                    <p>Manages team and physical resources</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">7</span>
                    <strong>Communications Management</strong>
                    <p>Ensures effective information flow</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">8</span>
                    <strong>Risk Management</strong>
                    <p>Identifies and manages uncertainties</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">9</span>
                    <strong>Procurement Management</strong>
                    <p>Manages external purchases</p>
                  </div>
                  <div class="ka-item">
                    <span class="ka-num">10</span>
                    <strong>Stakeholder Management</strong>
                    <p>Engages those affected by project</p>
                  </div>
                </div>
              `
            },
            {
              id: "w2l3",
              title: "Role of the Project Manager",
              duration: "25 min",
              content: `
                <h2>The Project Manager Role</h2>
                <p>The Project Manager (PM) is responsible for leading the team and ensuring project success.</p>

                <h3>Key Responsibilities</h3>
                <ul>
                  <li>Developing and managing the project plan</li>
                  <li>Leading and motivating the project team</li>
                  <li>Managing stakeholder expectations</li>
                  <li>Monitoring progress and managing changes</li>
                  <li>Ensuring deliverables meet quality standards</li>
                  <li>Managing risks and issues</li>
                </ul>

                <h3>Essential Skills</h3>
                <div class="skills-container">
                  <div class="skill-category">
                    <strong>Technical Skills</strong>
                    <ul>
                      <li>Project planning tools</li>
                      <li>Risk assessment</li>
                      <li>Budgeting</li>
                      <li>Quality management</li>
                    </ul>
                  </div>
                  <div class="skill-category">
                    <strong>Leadership Skills</strong>
                    <ul>
                      <li>Communication</li>
                      <li>Team building</li>
                      <li>Conflict resolution</li>
                      <li>Decision making</li>
                    </ul>
                  </div>
                  <div class="skill-category">
                    <strong>Business Skills</strong>
                    <ul>
                      <li>Strategic thinking</li>
                      <li>Negotiation</li>
                      <li>Problem solving</li>
                      <li>Organizational awareness</li>
                    </ul>
                  </div>
                </div>

                <h3>PM in IS Projects</h3>
                <p>IS Project Managers need additional competencies:</p>
                <ul>
                  <li>Understanding of technology and systems</li>
                  <li>Ability to translate between technical and business stakeholders</li>
                  <li>Knowledge of SDLC methodologies</li>
                  <li>Awareness of cybersecurity and compliance requirements</li>
                </ul>
              `
            }
          ],
          activities: [
            {
              id: "w2a1",
              title: "Framework Comparison",
              type: "analysis",
              description: "Compare PMBOK and Agile approaches for a given scenario.",
              instructions: [
                "Scenario: Your company needs to build a customer portal",
                "List pros and cons of using PMBOK approach",
                "List pros and cons of using Agile approach",
                "Recommend which framework to use and justify"
              ]
            },
            {
              id: "w2a2",
              title: "PM Skills Self-Assessment",
              type: "reflection",
              description: "Assess your own project management skills.",
              instructions: [
                "Rate yourself 1-5 on each of the PM skills mentioned",
                "Identify your top 3 strengths",
                "Identify 3 areas for improvement",
                "Create a brief development plan"
              ]
            }
          ],
          quiz: {
            id: "w2q",
            title: "Week 2 Assessment",
            questions: [
              {
                id: "w2q1",
                question: "How many Knowledge Areas are defined in PMBOK?",
                options: ["5", "8", "10", "12"],
                correct: 2,
                explanation: "PMBOK defines 10 Knowledge Areas: Integration, Scope, Schedule, Cost, Quality, Resource, Communications, Risk, Procurement, and Stakeholder Management."
              },
              {
                id: "w2q2",
                question: "Which Knowledge Area coordinates all other knowledge areas?",
                options: ["Scope Management", "Integration Management", "Resource Management", "Communications Management"],
                correct: 1,
                explanation: "Integration Management coordinates all other knowledge areas and ensures project elements work together effectively."
              },
              {
                id: "w2q3",
                question: "PRINCE2 is best described as:",
                options: ["Process-based approach", "Product-based approach", "Iterative approach", "Lean approach"],
                correct: 1,
                explanation: "PRINCE2 is a product-based approach that focuses on business justification and delivering defined products."
              },
              {
                id: "w2q4",
                question: "Which framework is best when requirements are expected to change?",
                options: ["Waterfall", "PMBOK traditional", "Agile", "PRINCE2"],
                correct: 2,
                explanation: "Agile is designed to accommodate changing requirements through iterative development and continuous feedback."
              },
              {
                id: "w2q5",
                question: "Which is NOT typically a PM responsibility?",
                options: ["Managing stakeholder expectations", "Writing all project code", "Leading the project team", "Monitoring project progress"],
                correct: 1,
                explanation: "Writing project code is typically done by developers. The PM leads the team but doesn't perform all technical work."
              }
            ]
          }
        },
        {
          number: 3,
          title: "Integration Management & Project Charter",
          icon: "ðŸ”—",
          color: "#8b5cf6",
          lessons: [
            {
              id: "w3l1",
              title: "Project Integration Management Overview",
              duration: "25 min",
              content: `
                <h2>Project Integration Management</h2>
                <p>Integration Management is the knowledge area that unifies, consolidates, and coordinates all other project management activities.</p>

                <h3>Why Integration Matters</h3>
                <p>Projects consist of many interrelated activities. Integration ensures:</p>
                <ul>
                  <li>All parts of the project work together cohesively</li>
                  <li>Trade-offs between competing objectives are managed</li>
                  <li>Changes are evaluated for impact across all areas</li>
                  <li>Project information is consolidated and communicated</li>
                </ul>

                <h3>Integration Management Processes</h3>
                <div class="process-list">
                  <div class="process-item">
                    <span class="process-phase">Initiation</span>
                    <strong>Develop Project Charter</strong>
                  </div>
                  <div class="process-item">
                    <span class="process-phase">Planning</span>
                    <strong>Develop Project Management Plan</strong>
                  </div>
                  <div class="process-item">
                    <span class="process-phase">Execution</span>
                    <strong>Direct and Manage Project Work</strong>
                  </div>
                  <div class="process-item">
                    <span class="process-phase">Execution</span>
                    <strong>Manage Project Knowledge</strong>
                  </div>
                  <div class="process-item">
                    <span class="process-phase">Monitoring</span>
                    <strong>Monitor and Control Project Work</strong>
                  </div>
                  <div class="process-item">
                    <span class="process-phase">Monitoring</span>
                    <strong>Perform Integrated Change Control</strong>
                  </div>
                  <div class="process-item">
                    <span class="process-phase">Closing</span>
                    <strong>Close Project or Phase</strong>
                  </div>
                </div>
              `
            },
            {
              id: "w3l2",
              title: "The Project Charter",
              duration: "35 min",
              content: `
                <h2>The Project Charter</h2>
                <p>The Project Charter is a document that formally authorizes the existence of a project and provides the project manager with the authority to apply organizational resources to project activities.</p>

                <h3>Purpose of the Charter</h3>
                <ul>
                  <li>Formally authorizes the project</li>
                  <li>Documents initial requirements and stakeholder needs</li>
                  <li>Establishes a partnership between performing and requesting organizations</li>
                  <li>Assigns the project manager and defines their authority level</li>
                </ul>

                <h3>Key Components</h3>
                <table>
                  <tr><th>Component</th><th>Description</th></tr>
                  <tr><td>Project Purpose</td><td>Why the project is being undertaken</td></tr>
                  <tr><td>Measurable Objectives</td><td>Specific, achievable project goals</td></tr>
                  <tr><td>High-Level Requirements</td><td>Initial stakeholder needs</td></tr>
                  <tr><td>High-Level Description</td><td>Overview of the project</td></tr>
                  <tr><td>Risks</td><td>Initial high-level risks identified</td></tr>
                  <tr><td>Summary Milestone Schedule</td><td>Key dates and phases</td></tr>
                  <tr><td>Summary Budget</td><td>Pre-approved financial resources</td></tr>
                  <tr><td>Stakeholder List</td><td>Key stakeholders identified</td></tr>
                  <tr><td>PM Assignment</td><td>Named PM with authority level</td></tr>
                  <tr><td>Sponsor Authorization</td><td>Signature authorizing the project</td></tr>
                </table>

                <h3>Who Creates the Charter?</h3>
                <p>The charter is typically developed by the project sponsor or initiator, often with input from the project manager if already assigned.</p>
              `
            },
            {
              id: "w3l3",
              title: "Creating an Effective Charter",
              duration: "30 min",
              content: `
                <h2>Creating an Effective Project Charter</h2>
                
                <h3>Best Practices</h3>
                <ul>
                  <li><strong>Keep it concise:</strong> 1-3 pages is typical</li>
                  <li><strong>Be specific:</strong> Avoid vague objectives</li>
                  <li><strong>Make it measurable:</strong> Include success criteria</li>
                  <li><strong>Get sign-off:</strong> Ensure sponsor approval</li>
                </ul>

                <h3>Sample Charter Template</h3>
                <div class="template-box">
                  <div class="template-section">
                    <strong>1. Project Information</strong>
                    <p>Project Name, Date, Sponsor, PM</p>
                  </div>
                  <div class="template-section">
                    <strong>2. Business Case</strong>
                    <p>Problem statement, opportunity, justification</p>
                  </div>
                  <div class="template-section">
                    <strong>3. Objectives & Success Criteria</strong>
                    <p>SMART goals with measurable outcomes</p>
                  </div>
                  <div class="template-section">
                    <strong>4. Scope Statement</strong>
                    <p>In-scope and out-of-scope items</p>
                  </div>
                  <div class="template-section">
                    <strong>5. Key Deliverables</strong>
                    <p>Major outputs of the project</p>
                  </div>
                  <div class="template-section">
                    <strong>6. Milestones & Timeline</strong>
                    <p>Key dates and phases</p>
                  </div>
                  <div class="template-section">
                    <strong>7. Budget Summary</strong>
                    <p>Estimated costs and funding</p>
                  </div>
                  <div class="template-section">
                    <strong>8. Risks & Assumptions</strong>
                    <p>Initial risks and assumptions made</p>
                  </div>
                  <div class="template-section">
                    <strong>9. Stakeholders</strong>
                    <p>Key stakeholders and their roles</p>
                  </div>
                  <div class="template-section">
                    <strong>10. Approval</strong>
                    <p>Signatures and authorization date</p>
                  </div>
                </div>

                <h3>Common Mistakes to Avoid</h3>
                <ul>
                  <li>Too much detail (save for planning)</li>
                  <li>Vague or unmeasurable objectives</li>
                  <li>Missing sponsor sign-off</li>
                  <li>Not identifying key stakeholders</li>
                  <li>Unrealistic timeline or budget</li>
                </ul>
              `
            }
          ],
          activities: [
            {
              id: "w3a1",
              title: "Draft a Project Charter",
              type: "practical",
              description: "Create a project charter for a hypothetical IS project.",
              instructions: [
                "Scenario: Your organization wants to implement a new HR Management System",
                "Create a 1-page project charter including all key components",
                "Define at least 3 SMART objectives",
                "Identify 5 key stakeholders and their interests",
                "List 3 major risks"
              ]
            },
            {
              id: "w3a2",
              title: "Charter Review Exercise",
              type: "analysis",
              description: "Analyze a project charter for completeness and quality.",
              instructions: [
                "Review the sample charter provided in the lesson",
                "Identify any missing components",
                "Evaluate the quality of objectives (are they SMART?)",
                "Suggest improvements"
              ]
            }
          ],
          quiz: {
            id: "w3q",
            title: "Week 3 Assessment",
            questions: [
              {
                id: "w3q1",
                question: "The Project Charter is created during which process group?",
                options: ["Planning", "Execution", "Initiation", "Closing"],
                correct: 2,
                explanation: "The Project Charter is created during the Initiation process group to formally authorize the project."
              },
              {
                id: "w3q2",
                question: "Who typically has the authority to approve the Project Charter?",
                options: ["Project Manager", "Team Lead", "Project Sponsor", "Stakeholder"],
                correct: 2,
                explanation: "The Project Sponsor, who provides funding and organizational support, typically approves the charter."
              },
              {
                id: "w3q3",
                question: "Which is NOT typically included in a Project Charter?",
                options: ["High-level requirements", "Detailed work breakdown structure", "Summary budget", "Project purpose"],
                correct: 1,
                explanation: "The detailed WBS is created during planning. The charter contains only high-level information."
              },
              {
                id: "w3q4",
                question: "Integration Management is important because it:",
                options: ["Creates the project budget", "Coordinates all other knowledge areas", "Manages only the project team", "Handles procurement"],
                correct: 1,
                explanation: "Integration Management coordinates and unifies all other knowledge areas to ensure the project works cohesively."
              },
              {
                id: "w3q5",
                question: "The primary output of the 'Develop Project Charter' process is:",
                options: ["Project Management Plan", "Project Charter", "Work Breakdown Structure", "Stakeholder Register"],
                correct: 1,
                explanation: "The Project Charter is the primary output of the Develop Project Charter process."
              }
            ]
          }
        },
        {
          number: 4,
          title: "Scope Management",
          icon: "ðŸŽ¯",
          color: "#f59e0b",
          lessons: [
            {
              id: "w4l1",
              title: "Project Scope Management Overview",
              duration: "25 min",
              content: `
                <h2>Project Scope Management</h2>
                <p>Scope Management includes the processes required to ensure that the project includes all the work required, and only the work required, to complete the project successfully.</p>

                <h3>Why Scope Management Matters</h3>
                <ul>
                  <li>Prevents scope creep (uncontrolled changes)</li>
                  <li>Ensures stakeholder expectations are met</li>
                  <li>Provides basis for schedule and cost estimates</li>
                  <li>Defines what the project will and will NOT deliver</li>
                </ul>

                <h3>Scope Management Processes</h3>
                <div class="process-flow">
                  <div class="flow-item">
                    <span>1</span>
                    <strong>Plan Scope Management</strong>
                    <p>Create the scope management plan</p>
                  </div>
                  <div class="flow-item">
                    <span>2</span>
                    <strong>Collect Requirements</strong>
                    <p>Gather stakeholder needs</p>
                  </div>
                  <div class="flow-item">
                    <span>3</span>
                    <strong>Define Scope</strong>
                    <p>Develop detailed scope statement</p>
                  </div>
                  <div class="flow-item">
                    <span>4</span>
                    <strong>Create WBS</strong>
                    <p>Break down deliverables</p>
                  </div>
                  <div class="flow-item">
                    <span>5</span>
                    <strong>Validate Scope</strong>
                    <p>Formal acceptance of deliverables</p>
                  </div>
                  <div class="flow-item">
                    <span>6</span>
                    <strong>Control Scope</strong>
                    <p>Monitor and manage changes</p>
                  </div>
                </div>

                <h3>Product Scope vs Project Scope</h3>
                <ul>
                  <li><strong>Product Scope:</strong> Features and functions of the product/service</li>
                  <li><strong>Project Scope:</strong> Work needed to deliver the product/service</li>
                </ul>
              `
            },
            {
              id: "w4l2",
              title: "Requirements Gathering",
              duration: "35 min",
              content: `
                <h2>Requirements Gathering</h2>
                <p>Collecting requirements is the process of determining, documenting, and managing stakeholder needs to meet project objectives.</p>

                <h3>Types of Requirements</h3>
                <div class="req-types">
                  <div class="req-type">
                    <strong>Business Requirements</strong>
                    <p>High-level needs of the organization</p>
                  </div>
                  <div class="req-type">
                    <strong>Stakeholder Requirements</strong>
                    <p>Needs of specific stakeholders</p>
                  </div>
                  <div class="req-type">
                    <strong>Solution Requirements</strong>
                    <p>Functional and non-functional requirements</p>
                  </div>
                  <div class="req-type">
                    <strong>Transition Requirements</strong>
                    <p>Temporary capabilities for migration</p>
                  </div>
                </div>

                <h3>Gathering Techniques</h3>
                <table>
                  <tr><th>Technique</th><th>Best For</th></tr>
                  <tr><td>Interviews</td><td>In-depth individual insights</td></tr>
                  <tr><td>Focus Groups</td><td>Group consensus and discussion</td></tr>
                  <tr><td>Workshops</td><td>Cross-functional requirements</td></tr>
                  <tr><td>Surveys</td><td>Large number of stakeholders</td></tr>
                  <tr><td>Observation</td><td>Understanding current processes</td></tr>
                  <tr><td>Prototyping</td><td>Clarifying user interface needs</td></tr>
                  <tr><td>Document Analysis</td><td>Existing system documentation</td></tr>
                </table>

                <h3>Requirements Documentation</h3>
                <p>Requirements should be:</p>
                <ul>
                  <li><strong>Clear:</strong> Unambiguous and understandable</li>
                  <li><strong>Complete:</strong> All necessary information included</li>
                  <li><strong>Consistent:</strong> No contradictions</li>
                  <li><strong>Testable:</strong> Can be verified</li>
                  <li><strong>Traceable:</strong> Linked to business objectives</li>
                </ul>
              `
            },
            {
              id: "w4l3",
              title: "The Scope Statement",
              duration: "30 min",
              content: `
                <h2>Project Scope Statement</h2>
                <p>The Project Scope Statement is a detailed description of the project and product scope, major deliverables, assumptions, and constraints.</p>

                <h3>Components of Scope Statement</h3>
                <div class="scope-components">
                  <div class="scope-item">
                    <strong>Product Scope Description</strong>
                    <p>Characteristics of the product/service</p>
                  </div>
                  <div class="scope-item">
                    <strong>Deliverables</strong>
                    <p>Unique products, services, or results</p>
                  </div>
                  <div class="scope-item">
                    <strong>Acceptance Criteria</strong>
                    <p>Conditions for accepting deliverables</p>
                  </div>
                  <div class="scope-item">
                    <strong>Project Exclusions</strong>
                    <p>What is explicitly out of scope</p>
                  </div>
                  <div class="scope-item">
                    <strong>Constraints</strong>
                    <p>Limitations on the project</p>
                  </div>
                  <div class="scope-item">
                    <strong>Assumptions</strong>
                    <p>Factors considered true for planning</p>
                  </div>
                </div>

                <h3>Example Exclusions (Out of Scope)</h3>
                <div class="example-box">
                  <p>For an HR System Implementation:</p>
                  <ul>
                    <li>Payroll processing module (separate project)</li>
                    <li>Integration with legacy finance system</li>
                    <li>Training for more than 50 users</li>
                    <li>Mobile app development</li>
                    <li>Data migration from paper records</li>
                  </ul>
                </div>

                <h3>Preventing Scope Creep</h3>
                <ul>
                  <li>Document scope clearly and get sign-off</li>
                  <li>Use a formal change control process</li>
                  <li>Communicate scope boundaries to stakeholders</li>
                  <li>Track and report scope changes</li>
                  <li>Assess impact before approving changes</li>
                </ul>
              `
            }
          ],
          activities: [
            {
              id: "w4a1",
              title: "Requirements Elicitation Exercise",
              type: "practical",
              description: "Practice gathering requirements for an IS project.",
              instructions: [
                "Scenario: Online Student Registration System",
                "Identify 5 key stakeholder groups",
                "List 3 requirements gathering techniques you would use",
                "Write 10 functional requirements",
                "Write 5 non-functional requirements"
              ]
            },
            {
              id: "w4a2",
              title: "Scope Statement Development",
              type: "practical",
              description: "Create a scope statement for a given project.",
              instructions: [
                "Project: Website Redesign for a university",
                "Write a product scope description",
                "List 5 major deliverables",
                "Define acceptance criteria for 2 deliverables",
                "Identify 5 items that are out of scope"
              ]
            }
          ],
          quiz: {
            id: "w4q",
            title: "Week 4 Assessment",
            questions: [
              {
                id: "w4q1",
                question: "Scope creep refers to:",
                options: ["Planned scope changes", "Uncontrolled changes to project scope", "Reducing project scope", "Scope validation process"],
                correct: 1,
                explanation: "Scope creep refers to uncontrolled changes or continuous growth in project scope without corresponding adjustments to time, cost, and resources."
              },
              {
                id: "w4q2",
                question: "Which technique is best for gathering requirements from a large group?",
                options: ["One-on-one interviews", "Observation", "Surveys/Questionnaires", "Prototyping"],
                correct: 2,
                explanation: "Surveys and questionnaires are efficient for gathering requirements from a large number of stakeholders."
              },
              {
                id: "w4q3",
                question: "The Scope Statement includes all EXCEPT:",
                options: ["Deliverables", "Project exclusions", "Detailed task schedule", "Acceptance criteria"],
                correct: 2,
                explanation: "The detailed task schedule is part of Schedule Management, not the Scope Statement."
              },
              {
                id: "w4q4",
                question: "Non-functional requirements typically describe:",
                options: ["What the system does", "How the system performs", "User stories", "Test cases"],
                correct: 1,
                explanation: "Non-functional requirements describe system qualities like performance, security, and usability - how the system performs."
              },
              {
                id: "w4q5",
                question: "Project exclusions in the scope statement help to:",
                options: ["Add more features", "Prevent misunderstandings about scope", "Increase project budget", "Extend timeline"],
                correct: 1,
                explanation: "Explicitly stating what is NOT included prevents misunderstandings and scope creep."
              }
            ]
          }
        },
        {
          number: 5,
          title: "Work Breakdown Structure",
          icon: "ðŸ“Š",
          color: "#ef4444",
          lessons: [
            {
              id: "w5l1",
              title: "Introduction to WBS",
              duration: "30 min",
              content: `
                <h2>Work Breakdown Structure (WBS)</h2>
                <p>The WBS is a hierarchical decomposition of the total scope of work to be carried out by the project team to accomplish the project objectives and create the required deliverables.</p>

                <h3>Why WBS is Critical</h3>
                <ul>
                  <li>Provides 100% of the project scope</li>
                  <li>Foundation for schedule and cost estimation</li>
                  <li>Assigns clear responsibility</li>
                  <li>Enables progress tracking</li>
                  <li>Facilitates communication</li>
                </ul>

                <h3>WBS Structure</h3>
                <div class="wbs-diagram">
                  <div class="wbs-level">
                    <span class="level-label">Level 0</span>
                    <div class="wbs-node root">Project Name</div>
                  </div>
                  <div class="wbs-level">
                    <span class="level-label">Level 1</span>
                    <div class="wbs-nodes">
                      <div class="wbs-node">Deliverable 1</div>
                      <div class="wbs-node">Deliverable 2</div>
                      <div class="wbs-node">Deliverable 3</div>
                    </div>
                  </div>
                  <div class="wbs-level">
                    <span class="level-label">Level 2</span>
                    <div class="wbs-nodes">
                      <div class="wbs-node small">Work Package 1.1</div>
                      <div class="wbs-node small">Work Package 1.2</div>
                      <div class="wbs-node small">Work Package 2.1</div>
                    </div>
                  </div>
                </div>

                <h3>Key Terminology</h3>
                <ul>
                  <li><strong>Work Package:</strong> Lowest level of WBS, can be scheduled and estimated</li>
                  <li><strong>WBS Dictionary:</strong> Document describing each WBS element</li>
                  <li><strong>Control Account:</strong> Management control point</li>
                  <li><strong>100% Rule:</strong> WBS must include 100% of project scope</li>
                </ul>
              `
            },
            {
              id: "w5l2",
              title: "Creating an Effective WBS",
              duration: "35 min",
              content: `
                <h2>Creating an Effective WBS</h2>
                
                <h3>Decomposition Guidelines</h3>
                <ul>
                  <li>Start with major deliverables</li>
                  <li>Decompose until work packages are manageable</li>
                  <li>Apply the 8/80 rule (8-80 hours per work package)</li>
                  <li>Ensure each element has clear deliverable</li>
                  <li>Use nouns, not verbs (deliverables, not activities)</li>
                </ul>

                <h3>WBS Formats</h3>
                <div class="format-comparison">
                  <div class="format">
                    <strong>Hierarchical Chart</strong>
                    <p>Visual tree structure showing relationships</p>
                    <p class="pros">âœ“ Easy to understand</p>
                    <p class="cons">âœ— Can become large</p>
                  </div>
                  <div class="format">
                    <strong>Indented List</strong>
                    <p>Outline format with numbered elements</p>
                    <p class="pros">âœ“ Detailed, easy to update</p>
                    <p class="cons">âœ— Less visual</p>
                  </div>
                </div>

                <h3>Example: Software Development WBS</h3>
                <div class="example-wbs">
                  <pre>
1.0 Software Development Project
  1.1 Requirements
    1.1.1 Requirements Document
    1.1.2 Use Cases
  1.2 Design
    1.2.1 System Architecture
    1.2.2 Database Design
    1.2.3 UI Mockups
  1.3 Development
    1.3.1 Backend Development
    1.3.2 Frontend Development
    1.3.3 Integration
  1.4 Testing
    1.4.1 Unit Testing
    1.4.2 System Testing
    1.4.3 User Acceptance Testing
  1.5 Deployment
    1.5.1 Documentation
    1.5.2 Training
    1.5.3 Go-Live
                  </pre>
                </div>

                <h3>Common Mistakes</h3>
                <ul>
                  <li>Including activities instead of deliverables</li>
                  <li>Not including all scope (violating 100% rule)</li>
                  <li>Too many or too few levels</li>
                  <li>Mixing deliverables with organizational structure</li>
                </ul>
              `
            },
            {
              id: "w5l3",
              title: "Scope Validation and Control",
              duration: "25 min",
              content: `
                <h2>Scope Validation and Control</h2>

                <h3>Validate Scope</h3>
                <p>Formalizing acceptance of completed project deliverables.</p>
                <ul>
                  <li>Occurs throughout the project (not just at the end)</li>
                  <li>Customer/sponsor reviews deliverables</li>
                  <li>Formal sign-off obtained</li>
                  <li>Unaccepted deliverables documented with reasons</li>
                </ul>

                <h3>Control Scope</h3>
                <p>Monitoring project scope and managing changes to the scope baseline.</p>
                
                <h4>Change Control Process</h4>
                <div class="change-process">
                  <div class="change-step">
                    <span>1</span>
                    <strong>Request</strong>
                    <p>Submit change request</p>
                  </div>
                  <div class="change-step">
                    <span>2</span>
                    <strong>Analyze</strong>
                    <p>Assess impact on scope, schedule, cost</p>
                  </div>
                  <div class="change-step">
                    <span>3</span>
                    <strong>Review</strong>
                    <p>Change Control Board evaluates</p>
                  </div>
                  <div class="change-step">
                    <span>4</span>
                    <strong>Decide</strong>
                    <p>Approve, reject, or defer</p>
                  </div>
                  <div class="change-step">
                    <span>5</span>
                    <strong>Implement</strong>
                    <p>Update baselines if approved</p>
                  </div>
                  <div class="change-step">
                    <span>6</span>
                    <strong>Communicate</strong>
                    <p>Inform stakeholders</p>
                  </div>
                </div>

                <h3>Variance Analysis</h3>
                <p>Comparing actual scope performance to the baseline:</p>
                <ul>
                  <li>Track completed vs. planned deliverables</li>
                  <li>Identify scope deviations early</li>
                  <li>Take corrective actions as needed</li>
                </ul>

                <h3>Keys to Scope Control Success</h3>
                <ul>
                  <li>Clear scope baseline documentation</li>
                  <li>Formal change control process</li>
                  <li>Regular scope reviews</li>
                  <li>Stakeholder engagement</li>
                  <li>Proactive communication</li>
                </ul>
              `
            }
          ],
          activities: [
            {
              id: "w5a1",
              title: "Create a WBS",
              type: "practical",
              description: "Develop a complete Work Breakdown Structure.",
              instructions: [
                "Project: E-commerce Website Development",
                "Create a WBS with at least 3 levels",
                "Include minimum 20 work packages",
                "Use proper WBS numbering",
                "Ensure 100% rule compliance"
              ]
            },
            {
              id: "w5a2",
              title: "Change Request Analysis",
              type: "case-study",
              description: "Analyze a scope change request and its impacts.",
              instructions: [
                "Scenario: Client requests adding a mobile app to the website project",
                "Document the change request",
                "Analyze impact on scope, schedule, and cost",
                "Recommend approval, rejection, or deferral",
                "Justify your recommendation"
              ]
            }
          ],
          quiz: {
            id: "w5q",
            title: "Week 5 Assessment",
            questions: [
              {
                id: "w5q1",
                question: "The 100% Rule in WBS means:",
                options: ["100% of team must participate", "WBS must include 100% of project scope", "100% completion before moving on", "Budget must be 100% allocated"],
                correct: 1,
                explanation: "The 100% Rule states that the WBS must include 100% of the work defined in the project scope - nothing more, nothing less."
              },
              {
                id: "w5q2",
                question: "Work packages in a WBS are:",
                options: ["The highest level elements", "The lowest level elements", "Management control points", "Phase gates"],
                correct: 1,
                explanation: "Work packages are the lowest level of the WBS and can be scheduled, estimated, monitored, and controlled."
              },
              {
                id: "w5q3",
                question: "The 8/80 rule suggests work packages should be:",
                options: ["8 to 80 days", "8 to 80 hours of effort", "8 to 80 team members", "8 to 80 tasks"],
                correct: 1,
                explanation: "The 8/80 rule is a guideline suggesting work packages should represent 8 to 80 hours of effort."
              },
              {
                id: "w5q4",
                question: "Validate Scope involves:",
                options: ["Creating the WBS", "Formal acceptance of deliverables", "Managing scope changes", "Decomposing work"],
                correct: 1,
                explanation: "Validate Scope is the process of obtaining formal acceptance of completed project deliverables."
              },
              {
                id: "w5q5",
                question: "The Change Control Board (CCB) is responsible for:",
                options: ["Writing code changes", "Reviewing and approving/rejecting changes", "Implementing all changes", "Creating the change log"],
                correct: 1,
                explanation: "The CCB is a group responsible for reviewing, evaluating, and approving or rejecting change requests."
              }
            ]
          }
        }
      ]
    };

    // Default configuration
    const defaultConfig = {
      course_title: "IS Project Management",
      instructor_name: "Course Instructor",
      welcome_message: "Welcome to your comprehensive project management journey!",
      background_color: "#f8fafc",
      surface_color: "#ffffff",
      text_color: "#1e293b",
      primary_action_color: "#22c55e",
      secondary_action_color: "#3b82f6",
      font_family: "Plus Jakarta Sans",
      font_size: 16
    };

    // State management
    let config = { ...defaultConfig };
    let progressData = [];
    let currentView = 'dashboard';
    let currentWeek = null;
    let currentLesson = null;
    let currentQuiz = null;
    let quizState = { currentQuestion: 0, answers: [], submitted: false };
    let isLoading = false;

    // Data SDK handler
    const dataHandler = {
      onDataChanged(data) {
        progressData = data;
        updateProgressUI();
      }
    };

    // Initialize SDKs
    async function initializeApp() {
      // Initialize Element SDK
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (newConfig) => {
            config = { ...config, ...newConfig };
            applyConfig();
          },
          mapToCapabilities: (cfg) => ({
            recolorables: [
              { get: () => cfg.background_color || defaultConfig.background_color, set: (v) => { cfg.background_color = v; window.elementSdk.setConfig({ background_color: v }); } },
              { get: () => cfg.surface_color || defaultConfig.surface_color, set: (v) => { cfg.surface_color = v; window.elementSdk.setConfig({ surface_color: v }); } },
              { get: () => cfg.text_color || defaultConfig.text_color, set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); } },
              { get: () => cfg.primary_action_color || defaultConfig.primary_action_color, set: (v) => { cfg.primary_action_color = v; window.elementSdk.setConfig({ primary_action_color: v }); } },
              { get: () => cfg.secondary_action_color || defaultConfig.secondary_action_color, set: (v) => { cfg.secondary_action_color = v; window.elementSdk.setConfig({ secondary_action_color: v }); } }
            ],
            borderables: [],
            fontEditable: { get: () => cfg.font_family || defaultConfig.font_family, set: (v) => { cfg.font_family = v; window.elementSdk.setConfig({ font_family: v }); } },
            fontSizeable: { get: () => cfg.font_size || defaultConfig.font_size, set: (v) => { cfg.font_size = v; window.elementSdk.setConfig({ font_size: v }); } }
          }),
          mapToEditPanelValues: (cfg) => new Map([
            ["course_title", cfg.course_title || defaultConfig.course_title],
            ["instructor_name", cfg.instructor_name || defaultConfig.instructor_name],
            ["welcome_message", cfg.welcome_message || defaultConfig.welcome_message]
          ])
        });
        if (window.elementSdk.config) {
          config = { ...config, ...window.elementSdk.config };
        }
      }

      // Initialize Data SDK
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          console.error("Failed to initialize Data SDK");
        }
      }

      render();
      applyConfig();
    }

    // Apply configuration to UI
    function applyConfig() {
      const app = document.getElementById('app');
      const bgColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
      const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;
      const fontFamily = config.font_family || defaultConfig.font_family;
      const fontSize = config.font_size || defaultConfig.font_size;

      document.body.style.backgroundColor = bgColor;
      document.body.style.color = textColor;
      document.body.style.fontFamily = `${fontFamily}, sans-serif`;
      document.body.style.fontSize = `${fontSize}px`;

      // Update CSS variables
      document.documentElement.style.setProperty('--bg-color', bgColor);
      document.documentElement.style.setProperty('--surface-color', surfaceColor);
      document.documentElement.style.setProperty('--text-color', textColor);
      document.documentElement.style.setProperty('--primary-color', primaryColor);
      document.documentElement.style.setProperty('--secondary-color', secondaryColor);

      // Update dynamic elements
      document.querySelectorAll('.course-title').forEach(el => {
        el.textContent = config.course_title || defaultConfig.course_title;
      });
      document.querySelectorAll('.instructor-name').forEach(el => {
        el.textContent = config.instructor_name || defaultConfig.instructor_name;
      });
      document.querySelectorAll('.welcome-message').forEach(el => {
        el.textContent = config.welcome_message || defaultConfig.welcome_message;
      });
      document.querySelectorAll('.surface-card').forEach(el => {
        el.style.backgroundColor = surfaceColor;
      });
      document.querySelectorAll('.primary-btn').forEach(el => {
        el.style.backgroundColor = primaryColor;
      });
      document.querySelectorAll('.secondary-btn').forEach(el => {
        el.style.backgroundColor = secondaryColor;
      });
    }

    // Progress tracking functions
    function getProgress(type, id) {
      return progressData.find(p => p.type === type && (p.lessonId === id || p.activityId === id || p.quizId === id));
    }

    function getWeekProgress(weekNum) {
      const week = courseData.weeks.find(w => w.number === weekNum);
      if (!week) return { completed: 0, total: 0, percentage: 0 };
      
      const totalLessons = week.lessons.length;
      const totalActivities = week.activities.length;
      const totalQuiz = 1;
      const total = totalLessons + totalActivities + totalQuiz;

      const completedLessons = week.lessons.filter(l => getProgress('lesson', l.id)?.completed).length;
      const completedActivities = week.activities.filter(a => getProgress('activity', a.id)?.completed).length;
      const completedQuiz = getProgress('quiz', week.quiz.id)?.completed ? 1 : 0;
      const completed = completedLessons + completedActivities + completedQuiz;

      return { completed, total, percentage: Math.round((completed / total) * 100) };
    }

    function getOverallProgress() {
      let completed = 0;
      let total = 0;
      courseData.weeks.forEach(week => {
        const wp = getWeekProgress(week.number);
        completed += wp.completed;
        total += wp.total;
      });
      return { completed, total, percentage: total > 0 ? Math.round((completed / total) * 100) : 0 };
    }

    async function markCompleted(type, id, weekNumber, score = null, maxScore = null) {
      if (isLoading) return;
      if (progressData.length >= 999) {
        showToast("Storage limit reached. Cannot save more progress.", "error");
        return;
      }

      const existing = getProgress(type, id);
      if (existing?.completed) return;

      isLoading = true;
      const record = {
        id: `${type}-${id}-${Date.now()}`,
        type,
        weekNumber,
        lessonId: type === 'lesson' ? id : null,
        activityId: type === 'activity' ? id : null,
        quizId: type === 'quiz' ? id : null,
        score: score,
        maxScore: maxScore,
        completed: true,
        answers: null,
        completedAt: new Date().toISOString()
      };

      if (window.dataSdk) {
        const result = await window.dataSdk.create(record);
        if (!result.isOk) {
          showToast("Failed to save progress", "error");
        }
      }
      isLoading = false;
    }

    function updateProgressUI() {
      // Update week cards
      document.querySelectorAll('.week-progress').forEach(el => {
        const weekNum = parseInt(el.dataset.week);
        const progress = getWeekProgress(weekNum);
        el.textContent = `${progress.percentage}%`;
        const bar = el.parentElement.querySelector('.progress-bar-fill');
        if (bar) bar.style.width = `${progress.percentage}%`;
      });

      // Update overall progress
      const overall = getOverallProgress();
      const overallEl = document.querySelector('.overall-progress');
      if (overallEl) {
        overallEl.textContent = `${overall.percentage}%`;
      }
      const overallBar = document.querySelector('.overall-progress-bar');
      if (overallBar) {
        overallBar.style.width = `${overall.percentage}%`;
      }

      // Update completion badges
      document.querySelectorAll('.completion-badge').forEach(el => {
        const type = el.dataset.type;
        const id = el.dataset.id;
        const completed = getProgress(type, id)?.completed;
        el.style.display = completed ? 'flex' : 'none';
      });
    }

    // Toast notification
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 animate-fade ${type === 'success' ? 'bg-green-500' : 'bg-red-500'} text-white`;
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Render functions
    function render() {
      const app = document.getElementById('app');
      
      switch (currentView) {
        case 'dashboard':
          renderDashboard(app);
          break;
        case 'week':
          renderWeek(app);
          break;
        case 'lesson':
          renderLesson(app);
          break;
        case 'quiz':
          renderQuiz(app);
          break;
        default:
          renderDashboard(app);
      }
      
      applyConfig();
      updateProgressUI();
    }

    function renderDashboard(container) {
      const overall = getOverallProgress();
      
      container.innerHTML = `
        <div class="min-h-full" style="background: linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, #e2e8f0 100%);">
          <!-- Header -->
          <header class="surface-card shadow-sm border-b border-slate-200" style="background: ${config.surface_color || defaultConfig.surface_color};">
            <div class="max-w-6xl mx-auto px-4 py-6">
              <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                  <h1 class="course-title text-2xl md:text-3xl font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};">${config.course_title || defaultConfig.course_title}</h1>
                  <p class="instructor-name text-slate-500 mt-1">Instructor: ${config.instructor_name || defaultConfig.instructor_name}</p>
                </div>
                <div class="flex items-center gap-4">
                  <div class="text-right">
                    <p class="text-sm text-slate-500">Overall Progress</p>
                    <p class="overall-progress text-2xl font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};">${overall.percentage}%</p>
                  </div>
                  <div class="w-16 h-16 relative">
                    <svg class="w-16 h-16 transform -rotate-90">
                      <circle cx="32" cy="32" r="28" fill="none" stroke="#e2e8f0" stroke-width="6"/>
                      <circle cx="32" cy="32" r="28" fill="none" stroke="${config.primary_action_color || defaultConfig.primary_action_color}" stroke-width="6" 
                        stroke-dasharray="${2 * Math.PI * 28}" 
                        stroke-dashoffset="${2 * Math.PI * 28 * (1 - overall.percentage / 100)}"
                        class="progress-ring"/>
                    </svg>
                    <span class="absolute inset-0 flex items-center justify-center text-lg">ðŸ“š</span>
                  </div>
                </div>
              </div>
            </div>
          </header>

          <!-- Welcome Banner -->
          <div class="max-w-6xl mx-auto px-4 py-6">
            <div class="surface-card rounded-2xl p-6 shadow-lg border border-slate-200 mb-8" style="background: linear-gradient(135deg, ${config.primary_action_color || defaultConfig.primary_action_color}15, ${config.secondary_action_color || defaultConfig.secondary_action_color}10);">
              <div class="flex items-center gap-4">
                <div class="text-4xl">ðŸŽ“</div>
                <div>
                  <h2 class="text-xl font-semibold mb-1">Welcome to the Course!</h2>
                  <p class="welcome-message text-slate-600">${config.welcome_message || defaultConfig.welcome_message}</p>
                </div>
              </div>
            </div>

            <!-- Progress Bar -->
            <div class="surface-card rounded-xl p-4 shadow mb-8" style="background: ${config.surface_color || defaultConfig.surface_color};">
              <div class="flex justify-between text-sm mb-2">
                <span class="font-medium">Course Completion</span>
                <span class="text-slate-500">${overall.completed} of ${overall.total} items completed</span>
              </div>
              <div class="h-3 bg-slate-200 rounded-full overflow-hidden">
                <div class="overall-progress-bar h-full rounded-full transition-all duration-500" style="width: ${overall.percentage}%; background: linear-gradient(90deg, ${config.primary_action_color || defaultConfig.primary_action_color}, ${config.secondary_action_color || defaultConfig.secondary_action_color});"></div>
              </div>
            </div>

            <!-- Weeks Grid -->
            <h2 class="text-xl font-bold mb-4">Course Modules</h2>
            <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
              ${courseData.weeks.map((week, idx) => {
                const progress = getWeekProgress(week.number);
                return `
                  <div class="surface-card lesson-card rounded-xl p-5 shadow-lg border border-slate-200 cursor-pointer transition-all duration-300 hover:shadow-xl animate-fade" 
                       style="animation-delay: ${idx * 0.1}s; background: ${config.surface_color || defaultConfig.surface_color};"
                       onclick="openWeek(${week.number})">
                    <div class="flex items-start justify-between mb-4">
                      <div class="text-4xl">${week.icon}</div>
                      <span class="px-3 py-1 rounded-full text-sm font-medium" style="background: ${week.color}20; color: ${week.color};">Week ${week.number}</span>
                    </div>
                    <h3 class="font-bold text-lg mb-2">${week.title}</h3>
                    <p class="text-slate-500 text-sm mb-4">${week.lessons.length} lessons â€¢ ${week.activities.length} activities â€¢ 1 quiz</p>
                    <div class="flex items-center gap-3">
                      <div class="flex-1 h-2 bg-slate-200 rounded-full overflow-hidden">
                        <div class="progress-bar-fill h-full rounded-full transition-all" style="width: ${progress.percentage}%; background: ${week.color};"></div>
                      </div>
                      <span class="week-progress text-sm font-semibold" data-week="${week.number}" style="color: ${week.color};">${progress.percentage}%</span>
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function openWeek(weekNum) {
      currentWeek = courseData.weeks.find(w => w.number === weekNum);
      currentView = 'week';
      render();
    }

    function renderWeek(container) {
      if (!currentWeek) return;
      const progress = getWeekProgress(currentWeek.number);
      
      container.innerHTML = `
        <div class="min-h-full" style="background: ${config.background_color || defaultConfig.background_color};">
          <!-- Header -->
          <header class="surface-card shadow-sm border-b border-slate-200 sticky top-0 z-10" style="background: ${config.surface_color || defaultConfig.surface_color};">
            <div class="max-w-4xl mx-auto px-4 py-4">
              <div class="flex items-center gap-4">
                <button onclick="goBack()" class="p-2 hover:bg-slate-100 rounded-lg transition-colors">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                  </svg>
                </button>
                <div class="flex-1">
                  <p class="text-sm text-slate-500">Week ${currentWeek.number}</p>
                  <h1 class="text-xl font-bold">${currentWeek.icon} ${currentWeek.title}</h1>
                </div>
                <div class="text-right">
                  <p class="text-2xl font-bold" style="color: ${currentWeek.color};">${progress.percentage}%</p>
                  <p class="text-xs text-slate-500">Complete</p>
                </div>
              </div>
            </div>
          </header>

          <div class="max-w-4xl mx-auto px-4 py-6">
            <!-- Lessons Section -->
            <section class="mb-8 animate-fade">
              <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                <span class="w-8 h-8 rounded-lg flex items-center justify-center text-white" style="background: ${currentWeek.color};">ðŸ“–</span>
                Lessons
              </h2>
              <div class="space-y-3">
                ${currentWeek.lessons.map((lesson, idx) => {
                  const completed = getProgress('lesson', lesson.id)?.completed;
                  return `
                    <div class="surface-card rounded-xl p-4 shadow border border-slate-200 cursor-pointer transition-all hover:shadow-md ${completed ? 'opacity-80' : ''}" 
                         style="background: ${config.surface_color || defaultConfig.surface_color};"
                         onclick="openLesson('${lesson.id}')">
                      <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center font-bold" 
                             style="background: ${completed ? currentWeek.color : currentWeek.color + '20'}; color: ${completed ? 'white' : currentWeek.color};">
                          ${completed ? 'âœ“' : idx + 1}
                        </div>
                        <div class="flex-1">
                          <h3 class="font-semibold">${lesson.title}</h3>
                          <p class="text-sm text-slate-500">${lesson.duration}</p>
                        </div>
                        <div class="completion-badge hidden items-center gap-1 px-2 py-1 rounded-full text-xs font-medium" 
                             data-type="lesson" data-id="${lesson.id}"
                             style="background: ${currentWeek.color}20; color: ${currentWeek.color}; display: ${completed ? 'flex' : 'none'};">
                          âœ“ Completed
                        </div>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </section>

            <!-- Activities Section -->
            <section class="mb-8 animate-fade" style="animation-delay: 0.1s;">
              <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                <span class="w-8 h-8 rounded-lg flex items-center justify-center text-white" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color};">âœï¸</span>
                Activities
              </h2>
              <div class="space-y-3">
                ${currentWeek.activities.map((activity, idx) => {
                  const completed = getProgress('activity', activity.id)?.completed;
                  return `
                    <div class="surface-card rounded-xl p-4 shadow border border-slate-200 ${completed ? 'opacity-80' : ''}" 
                         style="background: ${config.surface_color || defaultConfig.surface_color};">
                      <div class="flex items-start gap-4">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center font-bold shrink-0" 
                             style="background: ${completed ? config.secondary_action_color || defaultConfig.secondary_action_color : (config.secondary_action_color || defaultConfig.secondary_action_color) + '20'}; color: ${completed ? 'white' : config.secondary_action_color || defaultConfig.secondary_action_color};">
                          ${completed ? 'âœ“' : idx + 1}
                        </div>
                        <div class="flex-1">
                          <div class="flex items-center gap-2 mb-1">
                            <h3 class="font-semibold">${activity.title}</h3>
                            <span class="px-2 py-0.5 rounded text-xs" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color}20; color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">${activity.type}</span>
                          </div>
                          <p class="text-sm text-slate-600 mb-3">${activity.description}</p>
                          <div class="bg-slate-50 rounded-lg p-3">
                            <p class="text-xs font-semibold text-slate-500 mb-2">Instructions:</p>
                            <ul class="text-sm space-y-1">
                              ${activity.instructions.map(i => `<li class="flex items-start gap-2"><span style="color: ${config.secondary_action_color || defaultConfig.secondary_action_color};">â€¢</span>${i}</li>`).join('')}
                            </ul>
                          </div>
                          ${!completed ? `
                            <button onclick="completeActivity('${activity.id}')" 
                                    class="primary-btn mt-3 px-4 py-2 rounded-lg text-white text-sm font-medium transition-all hover:opacity-90"
                                    style="background: ${config.primary_action_color || defaultConfig.primary_action_color};">
                              Mark as Complete
                            </button>
                          ` : `
                            <div class="mt-3 flex items-center gap-2 text-sm font-medium" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};">
                              âœ“ Activity Completed
                            </div>
                          `}
                        </div>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </section>

            <!-- Quiz Section -->
            <section class="animate-fade" style="animation-delay: 0.2s;">
              <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                <span class="w-8 h-8 rounded-lg flex items-center justify-center text-white" style="background: #f59e0b;">ðŸ“</span>
                Assessment
              </h2>
              ${(() => {
                const quizProgress = getProgress('quiz', currentWeek.quiz.id);
                const completed = quizProgress?.completed;
                return `
                  <div class="surface-card rounded-xl p-5 shadow border border-slate-200" style="background: ${config.surface_color || defaultConfig.surface_color};">
                    <div class="flex items-center justify-between mb-4">
                      <div>
                        <h3 class="font-bold text-lg">${currentWeek.quiz.title}</h3>
                        <p class="text-sm text-slate-500">${currentWeek.quiz.questions.length} questions</p>
                      </div>
                      ${completed ? `
                        <div class="text-right">
                          <p class="text-2xl font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};">${quizProgress.score}/${quizProgress.maxScore}</p>
                          <p class="text-xs text-slate-500">Score</p>
                        </div>
                      ` : ''}
                    </div>
                    <button onclick="startQuiz()" 
                            class="w-full py-3 rounded-lg text-white font-semibold transition-all hover:opacity-90"
                            style="background: ${completed ? config.secondary_action_color || defaultConfig.secondary_action_color : config.primary_action_color || defaultConfig.primary_action_color};">
                      ${completed ? 'Review Quiz' : 'Start Quiz'}
                    </button>
                  </div>
                `;
              })()}
            </section>
          </div>
        </div>
      `;
    }

    function openLesson(lessonId) {
      currentLesson = currentWeek.lessons.find(l => l.id === lessonId);
      currentView = 'lesson';
      render();
    }

    function renderLesson(container) {
      if (!currentLesson || !currentWeek) return;
      const completed = getProgress('lesson', currentLesson.id)?.completed;
      const lessonIdx = currentWeek.lessons.findIndex(l => l.id === currentLesson.id);
      const nextLesson = currentWeek.lessons[lessonIdx + 1];
      const prevLesson = currentWeek.lessons[lessonIdx - 1];

      // Process content with styling
      const styledContent = currentLesson.content
        .replace(/<h2>/g, `<h2 class="text-2xl font-bold mb-4 mt-6" style="color: ${currentWeek.color};">`)
        .replace(/<h3>/g, `<h3 class="text-lg font-semibold mb-3 mt-5">`)
        .replace(/<h4>/g, `<h4 class="font-semibold mb-2 mt-4">`)
        .replace(/<ul>/g, '<ul class="space-y-2 mb-4 ml-4">')
        .replace(/<li>/g, `<li class="flex items-start gap-2"><span class="mt-1.5 w-1.5 h-1.5 rounded-full shrink-0" style="background: ${currentWeek.color};"></span><span>`)
        .replace(/<\/li>/g, '</span></li>')
        .replace(/<p>/g, '<p class="mb-4 leading-relaxed">')
        .replace(/<table>/g, `<table class="w-full border-collapse mb-4 rounded-lg overflow-hidden">`)
        .replace(/<tr>/g, '<tr class="border-b border-slate-200">')
        .replace(/<th>/g, `<th class="text-left p-3 font-semibold" style="background: ${currentWeek.color}20;">`)
        .replace(/<td>/g, '<td class="p-3">')
        .replace(/class="constraint-diagram"/g, 'class="grid gap-3 mb-4"')
        .replace(/class="constraint-item"/g, `class="p-3 rounded-lg border-l-4" style="background: ${currentWeek.color}10; border-color: ${currentWeek.color};"`)
        .replace(/class="phase-container"/g, 'class="grid gap-4 md:grid-cols-2 mb-4"')
        .replace(/class="phase"/g, `class="p-4 rounded-xl border" style="background: ${config.surface_color || defaultConfig.surface_color}; border-color: ${currentWeek.color}30;"`)
        .replace(/class="phase-num"/g, `class="inline-flex items-center justify-center w-8 h-8 rounded-full text-white font-bold mb-2" style="background: ${currentWeek.color};"`)
        .replace(/class="framework-grid"/g, 'class="grid gap-4 md:grid-cols-2 mb-4"')
        .replace(/class="framework-card"/g, `class="p-4 rounded-xl border" style="background: ${config.surface_color || defaultConfig.surface_color}; border-color: ${config.secondary_action_color || defaultConfig.secondary_action_color}30;"`)
        .replace(/class="knowledge-areas"/g, 'class="grid gap-3 md:grid-cols-2 mb-4"')
        .replace(/class="ka-item"/g, `class="p-3 rounded-lg flex items-start gap-3" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color}10;"`)
        .replace(/class="ka-num"/g, `class="inline-flex items-center justify-center w-7 h-7 rounded-full text-white text-sm font-bold shrink-0" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color};"`)
        .replace(/class="skills-container"/g, 'class="grid gap-4 md:grid-cols-3 mb-4"')
        .replace(/class="skill-category"/g, `class="p-4 rounded-xl" style="background: ${currentWeek.color}10;"`)
        .replace(/class="process-list"/g, 'class="space-y-3 mb-4"')
        .replace(/class="process-item"/g, `class="p-3 rounded-lg flex items-center gap-3" style="background: ${config.surface_color || defaultConfig.surface_color}; border: 1px solid ${currentWeek.color}30;"`)
        .replace(/class="process-phase"/g, `class="px-2 py-1 rounded text-xs font-medium" style="background: ${currentWeek.color}; color: white;"`)
        .replace(/class="template-box"/g, `class="space-y-2 mb-4 p-4 rounded-xl" style="background: ${currentWeek.color}10;"`)
        .replace(/class="template-section"/g, `class="p-3 rounded-lg" style="background: ${config.surface_color || defaultConfig.surface_color};"`)
        .replace(/class="example-box"/g, `class="p-4 rounded-xl mb-4" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color}10;"`)
        .replace(/class="process-flow"/g, 'class="grid gap-3 md:grid-cols-3 mb-4"')
        .replace(/class="flow-item"/g, `class="p-3 rounded-xl text-center" style="background: ${currentWeek.color}10;"`)
        .replace(/class="req-types"/g, 'class="grid gap-4 md:grid-cols-2 mb-4"')
        .replace(/class="req-type"/g, `class="p-4 rounded-xl" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color}10;"`)
        .replace(/class="scope-components"/g, 'class="grid gap-3 md:grid-cols-2 mb-4"')
        .replace(/class="scope-item"/g, `class="p-3 rounded-lg" style="background: ${currentWeek.color}10;"`)
        .replace(/class="wbs-diagram"/g, 'class="space-y-4 mb-4"')
        .replace(/class="wbs-level"/g, 'class="flex items-center gap-4"')
        .replace(/class="level-label"/g, 'class="text-sm text-slate-500 w-16 shrink-0"')
        .replace(/class="wbs-node root"/g, `class="px-4 py-2 rounded-lg font-bold text-white" style="background: ${currentWeek.color};"`)
        .replace(/class="wbs-node"/g, `class="px-3 py-2 rounded-lg" style="background: ${currentWeek.color}20;"`)
        .replace(/class="wbs-nodes"/g, 'class="flex flex-wrap gap-2"')
        .replace(/class="wbs-node small"/g, `class="px-2 py-1 rounded text-sm" style="background: ${currentWeek.color}10;"`)
        .replace(/class="format-comparison"/g, 'class="grid gap-4 md:grid-cols-2 mb-4"')
        .replace(/class="format"/g, `class="p-4 rounded-xl" style="background: ${config.surface_color || defaultConfig.surface_color}; border: 1px solid ${currentWeek.color}30;"`)
        .replace(/class="pros"/g, `class="text-sm mt-2" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};"`)
        .replace(/class="cons"/g, 'class="text-sm" style="color: #ef4444;"')
        .replace(/class="example-wbs"/g, `class="p-4 rounded-xl overflow-x-auto mb-4" style="background: ${currentWeek.color}10;"`)
        .replace(/<pre>/g, '<pre class="text-sm font-mono whitespace-pre">')
        .replace(/class="change-process"/g, 'class="grid gap-3 md:grid-cols-3 lg:grid-cols-6 mb-4"')
        .replace(/class="change-step"/g, `class="p-3 rounded-xl text-center" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color}10;"`);

      container.innerHTML = `
        <div class="min-h-full" style="background: ${config.background_color || defaultConfig.background_color};">
          <!-- Header -->
          <header class="surface-card shadow-sm border-b border-slate-200 sticky top-0 z-10" style="background: ${config.surface_color || defaultConfig.surface_color};">
            <div class="max-w-4xl mx-auto px-4 py-4">
              <div class="flex items-center gap-4">
                <button onclick="backToWeek()" class="p-2 hover:bg-slate-100 rounded-lg transition-colors">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                  </svg>
                </button>
                <div class="flex-1">
                  <p class="text-sm text-slate-500">Week ${currentWeek.number} â€¢ Lesson ${lessonIdx + 1}</p>
                  <h1 class="text-lg font-bold">${currentLesson.title}</h1>
                </div>
                <span class="text-sm text-slate-500">${currentLesson.duration}</span>
              </div>
            </div>
          </header>

          <!-- Content -->
          <div class="max-w-4xl mx-auto px-4 py-6">
            <div class="surface-card rounded-2xl p-6 md:p-8 shadow-lg animate-fade" style="background: ${config.surface_color || defaultConfig.surface_color};">
              <article class="prose max-w-none">
                ${styledContent}
              </article>
            </div>

            <!-- Navigation -->
            <div class="flex items-center justify-between mt-6 gap-4">
              ${prevLesson ? `
                <button onclick="openLesson('${prevLesson.id}')" class="flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-300 hover:bg-slate-100 transition-colors">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                  </svg>
                  Previous
                </button>
              ` : '<div></div>'}
              
              ${!completed ? `
                <button onclick="completeLesson('${currentLesson.id}')" 
                        class="primary-btn px-6 py-2 rounded-lg text-white font-semibold transition-all hover:opacity-90"
                        style="background: ${config.primary_action_color || defaultConfig.primary_action_color};">
                  Mark Complete
                </button>
              ` : `
                <span class="flex items-center gap-2 px-4 py-2 rounded-lg font-medium" style="background: ${config.primary_action_color || defaultConfig.primary_action_color}20; color: ${config.primary_action_color || defaultConfig.primary_action_color};">
                  âœ“ Completed
                </span>
              `}
              
              ${nextLesson ? `
                <button onclick="openLesson('${nextLesson.id}')" class="flex items-center gap-2 px-4 py-2 rounded-lg text-white transition-all hover:opacity-90" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color};">
                  Next
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </button>
              ` : `
                <button onclick="backToWeek()" class="flex items-center gap-2 px-4 py-2 rounded-lg text-white transition-all hover:opacity-90" style="background: ${config.primary_action_color || defaultConfig.primary_action_color};">
                  Back to Week
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </button>
              `}
            </div>
          </div>
        </div>
      `;
    }

    async function completeLesson(lessonId) {
      await markCompleted('lesson', lessonId, currentWeek.number);
      showToast('Lesson completed! ðŸŽ‰');
      render();
    }

    async function completeActivity(activityId) {
      await markCompleted('activity', activityId, currentWeek.number);
      showToast('Activity completed! Great work! ðŸ’ª');
      render();
    }

    function startQuiz() {
      currentQuiz = currentWeek.quiz;
      const existingProgress = getProgress('quiz', currentQuiz.id);
      quizState = { 
        currentQuestion: 0, 
        answers: existingProgress?.answers ? JSON.parse(existingProgress.answers) : [], 
        submitted: existingProgress?.completed || false 
      };
      currentView = 'quiz';
      render();
    }

    function renderQuiz(container) {
      if (!currentQuiz || !currentWeek) return;
      const question = currentQuiz.questions[quizState.currentQuestion];
      const totalQuestions = currentQuiz.questions.length;
      const existingProgress = getProgress('quiz', currentQuiz.id);

      container.innerHTML = `
        <div class="min-h-full" style="background: ${config.background_color || defaultConfig.background_color};">
          <!-- Header -->
          <header class="surface-card shadow-sm border-b border-slate-200 sticky top-0 z-10" style="background: ${config.surface_color || defaultConfig.surface_color};">
            <div class="max-w-3xl mx-auto px-4 py-4">
              <div class="flex items-center gap-4">
                <button onclick="backToWeek()" class="p-2 hover:bg-slate-100 rounded-lg transition-colors">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                  </svg>
                </button>
                <div class="flex-1">
                  <p class="text-sm text-slate-500">Week ${currentWeek.number}</p>
                  <h1 class="text-lg font-bold">${currentQuiz.title}</h1>
                </div>
                <div class="text-right">
                  <p class="text-sm font-semibold" style="color: ${currentWeek.color};">Question ${quizState.currentQuestion + 1}/${totalQuestions}</p>
                </div>
              </div>
              <!-- Progress bar -->
              <div class="h-1.5 bg-slate-200 rounded-full mt-3 overflow-hidden">
                <div class="h-full rounded-full transition-all duration-300" style="width: ${((quizState.currentQuestion + 1) / totalQuestions) * 100}%; background: ${currentWeek.color};"></div>
              </div>
            </div>
          </header>

          <div class="max-w-3xl mx-auto px-4 py-6">
            <div class="surface-card rounded-2xl p-6 md:p-8 shadow-lg animate-fade" style="background: ${config.surface_color || defaultConfig.surface_color};">
              <!-- Question -->
              <h2 class="text-xl font-bold mb-6">${question.question}</h2>

              <!-- Options -->
              <div class="space-y-3" id="quiz-options">
                ${question.options.map((option, idx) => {
                  const isSelected = quizState.answers[quizState.currentQuestion] === idx;
                  const isCorrect = quizState.submitted && idx === question.correct;
                  const isIncorrect = quizState.submitted && isSelected && idx !== question.correct;
                  
                  let optionClass = 'quiz-option';
                  if (isSelected && !quizState.submitted) optionClass += ' selected';
                  if (isCorrect) optionClass += ' correct';
                  if (isIncorrect) optionClass += ' incorrect';

                  return `
                    <button onclick="selectOption(${idx})" 
                            class="${optionClass} w-full p-4 rounded-xl border-2 text-left transition-all flex items-center gap-3 ${quizState.submitted ? 'cursor-default' : 'cursor-pointer'}"
                            ${quizState.submitted ? 'disabled' : ''}>
                      <span class="w-8 h-8 rounded-full border-2 flex items-center justify-center font-semibold shrink-0 ${isCorrect ? 'bg-green-500 border-green-500 text-white' : isIncorrect ? 'bg-red-500 border-red-500 text-white' : isSelected ? 'border-blue-500 bg-blue-500 text-white' : 'border-slate-300'}">
                        ${isCorrect ? 'âœ“' : isIncorrect ? 'âœ—' : String.fromCharCode(65 + idx)}
                      </span>
                      <span class="flex-1">${option}</span>
                    </button>
                  `;
                }).join('')}
              </div>

              ${quizState.submitted ? `
                <div class="mt-6 p-4 rounded-xl ${quizState.answers[quizState.currentQuestion] === question.correct ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}">
                  <p class="font-semibold mb-1 ${quizState.answers[quizState.currentQuestion] === question.correct ? 'text-green-700' : 'text-red-700'}">
                    ${quizState.answers[quizState.currentQuestion] === question.correct ? 'âœ“ Correct!' : 'âœ— Incorrect'}
                  </p>
                  <p class="text-sm text-slate-600">${question.explanation}</p>
                </div>
              ` : ''}
            </div>

            <!-- Navigation -->
            <div class="flex items-center justify-between mt-6 gap-4">
              ${quizState.currentQuestion > 0 ? `
                <button onclick="prevQuestion()" class="flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-300 hover:bg-white transition-colors">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                  </svg>
                  Previous
                </button>
              ` : '<div></div>'}

              ${!quizState.submitted ? `
                <button onclick="submitQuiz()" 
                        class="primary-btn px-6 py-2 rounded-lg text-white font-semibold transition-all hover:opacity-90 ${quizState.answers[quizState.currentQuestion] === undefined ? 'opacity-50 cursor-not-allowed' : ''}"
                        style="background: ${config.primary_action_color || defaultConfig.primary_action_color};"
                        ${quizState.answers[quizState.currentQuestion] === undefined ? 'disabled' : ''}>
                  ${quizState.currentQuestion === totalQuestions - 1 ? 'Submit Quiz' : 'Check Answer'}
                </button>
              ` : `
                ${quizState.currentQuestion < totalQuestions - 1 ? `
                  <button onclick="nextQuestion()" class="flex items-center gap-2 px-6 py-2 rounded-lg text-white font-semibold transition-all hover:opacity-90" style="background: ${config.secondary_action_color || defaultConfig.secondary_action_color};">
                    Next Question
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                  </button>
                ` : `
                  <button onclick="finishQuiz()" class="flex items-center gap-2 px-6 py-2 rounded-lg text-white font-semibold transition-all hover:opacity-90" style="background: ${config.primary_action_color || defaultConfig.primary_action_color};">
                    See Results
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                  </button>
                `}
              `}
            </div>

            ${quizState.submitted && existingProgress?.completed ? `
              <div class="mt-6 surface-card rounded-xl p-4 shadow" style="background: ${config.surface_color || defaultConfig.surface_color};">
                <div class="flex items-center justify-between">
                  <span class="text-sm text-slate-500">Your Score</span>
                  <span class="text-xl font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};">${existingProgress.score}/${existingProgress.maxScore}</span>
                </div>
              </div>
            ` : ''}
          </div>
        </div>
      `;
    }

    function selectOption(idx) {
      if (quizState.submitted) return;
      quizState.answers[quizState.currentQuestion] = idx;
      render();
    }

    async function submitQuiz() {
      quizState.submitted = true;
      
      // If last question, save progress
      if (quizState.currentQuestion === currentQuiz.questions.length - 1) {
        const score = quizState.answers.reduce((acc, ans, idx) => {
          return acc + (ans === currentQuiz.questions[idx].correct ? 1 : 0);
        }, 0);
        
        const existingProgress = getProgress('quiz', currentQuiz.id);
        if (!existingProgress?.completed) {
          await markCompleted('quiz', currentQuiz.id, currentWeek.number, score, currentQuiz.questions.length);
        }
      }
      
      render();
    }

    function nextQuestion() {
      if (quizState.currentQuestion < currentQuiz.questions.length - 1) {
        quizState.currentQuestion++;
        quizState.submitted = getProgress('quiz', currentQuiz.id)?.completed || false;
        render();
      }
    }

    function prevQuestion() {
      if (quizState.currentQuestion > 0) {
        quizState.currentQuestion--;
        quizState.submitted = getProgress('quiz', currentQuiz.id)?.completed || false;
        render();
      }
    }

    function finishQuiz() {
      const score = quizState.answers.reduce((acc, ans, idx) => {
        return acc + (ans === currentQuiz.questions[idx].correct ? 1 : 0);
      }, 0);
      
      showToast(`Quiz completed! Score: ${score}/${currentQuiz.questions.length} ðŸŽ‰`);
      backToWeek();
    }

    function goBack() {
      currentView = 'dashboard';
      currentWeek = null;
      currentLesson = null;
      currentQuiz = null;
      render();
    }

    function backToWeek() {
      currentView = 'week';
      currentLesson = null;
      currentQuiz = null;
      render();
    }

    // Initialize on load
    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cd44f954493fed1',t:'MTc3MDk4NTU1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
